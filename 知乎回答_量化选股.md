# 如何通过量化的方式选出合适的股票?

作为一个量化选股系统的开发者,我想分享一下我在沪深300股票池中实践的**5维评分选股法**,这套方法已经在实盘中运行,并且开源在GitHub上。

---

## 一、核心思路:多维度量化评分体系

单一指标选股容易失效,我们需要建立一个**综合评分系统**,从多个维度评估股票质量。

我的系统采用**5维评分法**(满分100分):

```
总分 = 技术面(30分) + 估值(25分) + 盈利质量(30分) + 安全性(10分) + 分红(5分)
```

### 为什么是这5个维度?

1. **技术面(30%)** - 捕捉短期动量和市场情绪
2. **估值(25%)** - 避免买贵,寻找性价比
3. **盈利质量(30%)** - 核心!公司赚钱能力才是根本
4. **安全性(10%)** - 控制风险,避免踩雷
5. **分红(5%)** - 现金流回报,验证盈利真实性

---

## 二、详细评分标准(v4.4优化版)

### 1️⃣ 技术面(30分) - 趋势追踪

```python
# 当日涨幅 (10分)
if change_pct > 5%:   score += 10分  # 强势上涨
elif change_pct > 2%: score += 7分
elif change_pct > 0:  score += 4分

# 20日动量 (15分) - 核心指标
if momentum_20d > 15%: score += 15分  # 短期趋势强劲
elif momentum_20d > 10%: score += 12分
elif momentum_20d > 5%:  score += 8分

# 流动性 (5分)
if 成交额 > 1.5亿: score += 5分  # 确保能买得进卖得出
```

**逻辑**: 趋势是你的朋友,顺势而为。但不能只看技术面,否则容易追高。

---

### 2️⃣ 估值(25分) - 安全边际

这是v4.4的重大优化,对成长股更友好:

```python
# PE市盈率 (10分)
if PE < 10:  score += 10分  # 低估值
elif PE < 20: score += 7分   # 合理估值
elif PE < 30: score += 4分   # 适中估值

# PB市净率 (10分) - v4.4放宽标准
if PB < 2:  score += 10分    # 低估
elif PB < 4: score += 8分    # 合理(包容成长股)
elif PB < 7: score += 5分    # 适中(宁德时代这类优质成长股)
elif PB < 10: score += 2分   # 偏高但可接受

# PEG (5分)
if PEG < 1:   score += 5分   # 优质成长股
elif PEG < 1.5: score += 3分
```

**关键优化**:
- 旧版本PB>5即0分,导致很多优质成长股被过滤
- 新版本PB<10都给分,**更符合A股市场实际情况**

---

### 3️⃣ 盈利质量(30分) - 最核心!

```python
# ROE净资产收益率 (15分) - 巴菲特最看重的指标
if ROE > 20%: score += 15分  # 优秀公司(茅台、美的、平安)
elif ROE > 15%: score += 12分  # 良好
elif ROE > 10%: score += 8分   # 及格

# 利润增长率 (15分)
if profit_growth > 30%: score += 15分  # 高成长
elif profit_growth > 20%: score += 12分
elif profit_growth > 10%: score += 8分
```

**ROE计算技巧**:
由于财报数据难获取,我用了一个巧妙的公式:

```python
ROE = (PB / PE) × 100

# 原理: ROE = 净利润/净资产
#       PB = 市值/净资产, PE = 市值/净利润
#       所以 PB/PE = ROE
```

**验证准确性**:
- 贵州茅台: PB=13.95, PE=36 → ROE=38.7% ✓ (与财报一致)
- 平安银行: PB=0.59, PE=4.61 → ROE=12.8% ✓

---

### 4️⃣ 安全性(10分) - 风险控制

v4.4优化: 明确区分"估值合理性"和"安全边际"

```python
# PB安全边际 (3分) - 范围严格
if PB < 1.0:  score += 3分   # 破净,极度安全
elif PB < 1.5: score += 2分  # 接近破净
elif PB < 2.5: score += 1分  # 低估值区

# 股息率 (3分)
if dividend_yield > 5%: score += 3分  # 高分红,经营稳定
elif dividend_yield > 3%: score += 2分

# 换手率 (4分) - v4.4增加权重
if turnover_rate < 2%: score += 4分   # 筹码稳定,非投机股
elif turnover_rate < 5%: score += 3分
```

**设计思路**:
- 估值部分的PB看"便宜吗",范围0-10
- 安全性部分的PB看"安全吗",范围0-2.5
- 两者角度不同,避免重复评分过重

---

### 5️⃣ 分红(5分) - 现金流验证

```python
if dividend_yield > 5%: score += 5分
elif dividend_yield > 3%: score += 4分
elif dividend_yield > 2%: score += 2分
```

高分红说明:
1. 公司有真实现金流
2. 管理层对股东友好
3. 经营稳定,不需要大量资本开支

---

## 三、实战案例分析

### 案例1: 低估值价值股 - 新华保险

```
PE=7.17, PB=2.57, ROE=35.8%, 股息率=7.25%

评分:
- 技术面: 22分 (20日动量+17%)
- 估值: 23分 (PE满分10分, PB=10分)
- 盈利质量: 27分 (ROE优秀, 利润增长28.6%)
- 安全性: 7分
- 分红: 5分

总分: 84分(A级) ⭐
```

**选股理由**: 超低估值+高ROE+高分红,典型的价值股

---

### 案例2: 成长股 - 洛阳钼业

```
PE=18.37, PB=4.62, ROE=25.1%, 当日涨幅+5.53%

评分:
- 技术面: 30分 (满分! 当日+5.53%, 20日动量+34%)
- 估值: 15分 (PB=4.62在新标准下拿5分)
- 盈利质量: 19分
- 安全性: 7分
- 分红: 5分

总分: 76分(A级) ⭐
```

**关键**: 在旧标准下,PB=4.62可能只拿2分,总分可能不到70分。新标准对成长股更友好!

---

### 案例3: 高估值股被过滤 - 某科技股

```
PE=35, PB=12, ROE=34.3%

评分:
- 技术面: 7分 (下跌, 动量负)
- 估值: 0分 ❌ (PE≥30, PB≥10都是0分)
- 盈利质量: 19分 (虽然ROE高)
- 安全性: 0分 ❌
- 分红: 1分

总分: 27分(D级) ❌
```

**结论**: 即使ROE很高,但估值过高+技术面弱,会被有效过滤掉。

---

## 四、筛选流程

### 第1步: 确定股票池

```python
股票池 = 沪深300成分股  # 避免垃圾股
```

为什么选沪深300?
- 流动性好,不会买不进卖不出
- 公司质量有保证
- 数据容易获取

### 第2步: 基础过滤

```python
if PE > 30:     剔除  # 估值过高
if 成交额 < 5000万: 剔除  # 流动性差
if price < 1元:   剔除  # ST风险股
if 涨跌幅 == 0 and 成交额很小: 剔除  # 停牌股
```

### 第3步: 计算综合评分

对每只股票计算5维评分,求总分。

### 第4步: 排序并选出TOP股票

```python
# 按总分排序
sorted_stocks = sorted(stocks, key=lambda x: x['score'], reverse=True)

# 筛选最低分数线
qualified_stocks = [s for s in sorted_stocks if s['score'] >= 40]

# 选出TOP 5-10只
final_selection = qualified_stocks[:5]
```

### 第5步: 生成选股理由

```python
selection_reason = f"""
PE={pe:.2f}；PB={pb:.2f}；
20日动量强劲；ROE优秀({roe:.1f}%)；
高成长({profit_growth:.1f}%)；
安全性良好；综合{grade}级({score:.1f}分)
"""
```

---

## 五、关键技术细节

### 1. 数据获取

```python
# 使用腾讯财经API,稳定可靠
url = f"https://qt.gtimg.cn/q=sh{stock_code}"
response = requests.get(url, headers=headers)

# 解析返回数据
data_parts = response.text.split('~')
pe = float(data_parts[39])   # PE
pb = float(data_parts[46])   # PB
turnover_rate = float(data_parts[56])  # 换手率
```

### 2. 20日动量计算

```python
def calculate_momentum(price_data, days=20):
    recent_prices = price_data['close'].tail(days)
    momentum = (recent_prices[-1] / recent_prices[0] - 1) * 100
    return momentum
```

### 3. 智能缓存机制

```python
# 历史数据缓存1小时
cache_key = f"{stock_code}_{date}"
if cache_key in cache and time.time() - cache_time < 3600:
    return cached_data
```

---

## 六、回测验证

### 单日回测示例

```
📅 回测日期: 2025-04-07 | 持有1天

🏆 筛选结果:
   #1 天坛生物: PE=20, 分数=90 → 次日涨 +5.14%
   #2 龙源电力: PE=20, 分数=80 → 次日涨 +1.82%
   #3 东鹏饮料: PE=20, 分数=65 → 次日涨 +0.40%

📊 策略表现:
   • 平均收益: +2.46%
   • 胜率: 100% (3/3)
```

---

## 七、常见问题

### Q1: 为什么不用更多指标?

**答**: 贪多嚼不烂。5个维度已经覆盖了:
- 市场情绪(技术面)
- 估值水平(估值)
- 赚钱能力(盈利质量)
- 风险控制(安全性)
- 现金回报(分红)

更多指标可能导致过拟合,在历史数据上表现好,实盘却失效。

### Q2: 这套系统适合什么市场?

**答**:
- ✅ 震荡市、慢牛市 - 效果最好
- ⚠️ 单边牛市 - 会错过很多妖股
- ⚠️ 暴跌熊市 - 需要降低仓位或空仓

量化系统不是圣杯,需要结合市场环境。

### Q3: 多久调整一次持仓?

**答**: 我的实盘策略:
- 每日16:00盘后分析
- 次日开盘根据信号调仓
- 持股周期: 1-5天(短线动量策略)

如果是价值投资风格,可以降低调仓频率。

### Q4: 如何处理数据缺失?

**答**:
```python
# 如果某个指标缺失,该项得0分
if pb is None:
    pb_score = 0
else:
    pb_score = calculate_pb_score(pb)
```

缺失数据的股票总分会偏低,自然被过滤掉。

---

## 八、风险提示

1. **量化系统不是圣杯** - 没有100%胜率的策略
2. **需要持续迭代** - 市场在变,策略也要进化
3. **控制仓位** - 即使信号再强,单只股票不超过总仓位20%
4. **设置止损** - 亏损超过5%及时止损
5. **避免过度交易** - 频繁换股会产生大量交易成本

---

## 九、开源项目

这套系统已开源: **https://github.com/stevenwxz/JYSstock_analyzer**

包含:
- ✅ 完整的评分系统代码
- ✅ 历史回测模块
- ✅ 邮件自动推送
- ✅ 详细的文档说明

欢迎Star和Fork,一起交流优化!

---

## 十、总结

量化选股的核心是**建立可复制、可回测的评分体系**:

1. **多维度评估** - 不依赖单一指标
2. **动态权重** - 技术面30%+基本面70%的平衡
3. **持续优化** - v4.4放宽PB标准就是根据实盘反馈优化
4. **严格执行** - 去除人性弱点,严格按信号操作

记住:
> 量化选股是概率游戏,追求的是**长期稳定盈利**,而不是单次暴利。

---

**最后**:
市场有风险,投资需谨慎。本文仅为技术分享,不构成投资建议。

如果觉得有帮助,欢迎点赞收藏!有问题可以评论区交流~

---

**作者**: 专注量化交易的程序员
**更新时间**: 2025-10-26
**系统版本**: v4.4
**GitHub**: https://github.com/stevenwxz/JYSstock_analyzer
